\begin{frame}\frametitle{Background}
Main idea: train a network on a "fake task" then use the weights as embedding. \bigskip
\begin{itemize}
\item The fake task:
\item Given a word $w$ guess the context words. 
\item We want to maximize the following probability:
\end{itemize}
\begin{equation}
\prod_{t=1}^T \prod_{-m<j<m}  p(w_{t+j}|w_t)
\end{equation}
\includegraphics[scale=0.37]{images/context_pairs.png}
\end{frame}

\begin{frame}\frametitle{Background}\framesubtitle{Network achitecture}
\includegraphics[scale=0.37]{images/ntw_architecture.png}
(Source: http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/) 
\end{frame}

\begin{frame}\frametitle{Background}\framesubtitle{Example}
$
\begin{bmatrix}
0 & 0 & 1 & 0 
\end{bmatrix}
\begin{bmatrix}
1 & 3 & 1.2  \\
0.3 & 0.2 & -1 \\
1 & 2 & 3 \\
-2 & 3 & 1 \\
-1 & 0 & 1 \\
\end{bmatrix}
= 
\begin{bmatrix}
1& 2 & 3
\end{bmatrix}
$
\bigskip
$
\begin{bmatrix}
1& 2 & 3
\end{bmatrix}
\begin{bmatrix}
0.1 & 0.25&0.5& 1  \\
0.1 & 0.25&0.5 & 1 \\
0.1 & 0.25&0.5 & 1 \\
\end{bmatrix}
= 
\begin{bmatrix}
0.6 & 1.5 & 3 & 6 
\end{bmatrix}
$
\bigskip 
\\Apply Softmax:
$
\begin{bmatrix}
0. & 0.1 & 0.5 & 0.94
\end{bmatrix}
$
\end{frame}

\begin{frame}\frametitle{Background}\framesubtitle{Softmax}
\begin{Large}
It's unsuitable to compute the softmax
\end{Large}
   \begin{equation}
  p(c|w) =  \frac{exp( {v^{'}_c}^\intercal v_w )}{\sum_{i=1}^T exp({v^{'}_i}^\intercal v_{w})}
   \end{equation}
   \begin{itemize}
   \item $v_w$ and $v^{'}_c$ are the "input" and "output" representation of $w$
\item For each pair we have to go over the whole training corpus. (Billions of word in practice) 
   \end{itemize}
\end{frame}

\begin{frame}\frametitle{Background}\framesubtitle{Negative Sampling}
\begin{large}
Negative Sampling
\end{large}
\begin{itemize}
\item Distinguish data from noise $\Rightarrow$ reduce problem to a logistic regression. 
\item Guess k random samples 
\end{itemize}
  \begin{equation}
  p(c|w) =  log(\sigma({v^{'}_c}^\intercal v_w ) + \sum_{k\in K} \sigma(log(-{v^{'}_k}^\intercal  v_w ))  
  \end{equation}
\end{frame}